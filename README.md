# Learning to Generate Realistic Noisy Images via Pixel-level Noise-aware Adversarial Training (NeurIPS 2021)
[![lb](https://img.shields.io/badge/DND-leaderboard-179bd3)](https://noise.visinf.tu-darmstadt.de/benchmark/#results_srgb)
[![paper](https://img.shields.io/badge/NeurIPS-paper-179bd3)](https://proceedings.neurips.cc/paper/2021/file/1a5b1e4daae265b790965a275b53ae50-Paper.pdf)
[![supp](https://img.shields.io/badge/NeurIPS-supplementary_matrial-179bd3)](https://proceedings.neurips.cc/paper/2021/file/1a5b1e4daae265b790965a275b53ae50-Supplemental.pdf)


<hr />

> **Abstract:** *Existing deep learning real denoising methods require a large amount of noisy-clean image pairs for supervision. Nonetheless, capturing a  real noisy-clean dataset is an unacceptable expensive and cumbersome procedure. To alleviate this problem, this work investigates how to generate realistic noisy images. Firstly, we formulate a simple yet reasonable noise model that treats each real noisy pixel as a random variable. This model splits the noisy image generation problem into two sub-problems: image domain alignment and noise domain alignment. Subsequently, we propose a novel framework, namely Pixel-level Noise-aware Generative Adversarial Network (PNGAN). PNGAN employs a pre-trained real denoiser to map the fake and real noisy images into a nearly noise-free solution space to perform image domain alignment. Simultaneously, PNGAN establishes a pixel-level adversarial training to conduct noise domain alignment. Additionally, for better noise fitting, we present an efficient architecture Simple Multi-scale Network (SMNet) as the generator. Qualitative validation shows that noise generated by PNGAN is highly similar to real noise in terms of intensity and distribution. Quantitative experiments demonstrate that a series of denoisers trained with the generated noisy images achieve state-of-the-art (SOTA) results on four real denoising benchmarks.* 
<hr />


 ![Illustration of PNGAN](/figure/PNGAN.png)

# Main Results
The quantitative results of models finetuned with the image pairs generated by our PNGAN are listed in the following table. Our models achieve state-of-the-art results.
 ![Main Results of PNGAN](/figure/main.png)

 # Noise Generation
 The qualitative comparisons of noise generation between previous methods and our PNGAN are shown in the following figure. Our PNGAN creates more realistic and visually natural noisy images.
  ![noise compare of PNGAN](/figure/noisy.png)

# Noise Removal
We provide the denoised results on [DND](https://noise.visinf.tu-darmstadt.de/) benchmark, see folder 'DND_results'. Our method ranks the 4th place on the public [leaderboard](https://noise.visinf.tu-darmstadt.de/benchmark/#results_srgb).

# Citation
```
@inproceedings{cai2021learning, 
title={Learning to Generate Realistic Noisy Images via Pixel-level Noise-aware Adversarial Training}, 
author={Cai, Yuanhao and Hu, Xiaowan and Wang, Haoqian and Zhang, Yulun and Pfister, Hanspeter and Wei, Donglai}, 
booktitle={Thirty-Fifth Conference on Neural Information Processing Systems}, 
year={2021}}
```
